import{_ as G,r as B,i as c,j as H,k as J,n as K,p as w,o as b,w as t,d as s,u as O,b as e,e as l,f as u,m as h,h as d,q as P,s as F,t as Q,v as W,x as X,y as Y,z as r,A as N,B as Z,g as ee}from"./index-Dwetklps.js";import{m as te}from"./mail-BVuPHEDu.js";const ae={class:"logo"},le={class:"compose-btn"},oe={class:"user-info"},se={class:"user-avatar"},ne={class:"username"},ue={class:"header-left"},de={class:"page-title"},re={class:"header-right"},_e={class:"user-profile"},ie={class:"user-details"},ce={class:"user-name"},me={class:"user-email"},fe={__name:"MainLayout",setup(pe){const f=O(),p=H(),v=B(0),g=B(0),V=c(()=>{var o;return((o=p.meta)==null?void 0:o.folder)||"inbox"}),$=c(()=>{var o;return((o=p.meta)==null?void 0:o.title)||"邮件"}),_=c(()=>localStorage.getItem("username")||"User"),k=c(()=>localStorage.getItem("email")||`${_.value}@campus.mail`),x=c(()=>_.value.charAt(0).toUpperCase()),C=async()=>{try{const o=localStorage.getItem("userId");if(o){const a=await te.getStats(o);v.value=a.unreadCount||0,g.value=a.draftsCount||0}}catch(o){console.error("获取邮件统计失败:",o)}};J(()=>{C()}),K(()=>p.path,()=>{C()});const L=o=>{f.push(`/${o}`)},I=()=>{localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("username"),localStorage.removeItem("email"),localStorage.removeItem("nickname"),f.push("/login")},E=()=>{f.push("/accounts")};return(o,a)=>{const n=s("el-icon"),R=s("el-button"),S=s("el-badge"),m=s("el-menu-item"),T=s("el-menu"),y=s("el-avatar"),i=s("el-dropdown-item"),M=s("el-dropdown-menu"),z=s("el-dropdown"),U=s("el-aside"),j=s("el-header"),q=s("router-view"),D=s("el-main"),A=s("el-container");return b(),w(A,{class:"main-layout"},{default:t(()=>[e(U,{width:"220px",class:"sidebar"},{default:t(()=>[l("div",ae,[e(n,{size:28,color:"#409EFF"},{default:t(()=>[e(u(h))]),_:1}),a[1]||(a[1]=l("span",null,"Campus Mail",-1))]),l("div",le,[e(R,{type:"primary",size:"large",onClick:a[0]||(a[0]=ve=>o.$router.push("/compose"))},{default:t(()=>[e(n,null,{default:t(()=>[e(u(P))]),_:1}),a[2]||(a[2]=d(" 写邮件 ",-1))]),_:1})]),e(T,{"default-active":V.value,class:"folder-menu",onSelect:L},{default:t(()=>[e(m,{index:"inbox"},{default:t(()=>[e(n,null,{default:t(()=>[e(u(Q))]),_:1}),a[3]||(a[3]=l("span",null,"收件箱",-1)),v.value>0?(b(),w(S,{key:0,value:v.value,class:"folder-badge"},null,8,["value"])):F("",!0)]),_:1}),e(m,{index:"sent"},{default:t(()=>[e(n,null,{default:t(()=>[e(u(W))]),_:1}),a[4]||(a[4]=l("span",null,"发件箱",-1))]),_:1}),e(m,{index:"drafts"},{default:t(()=>[e(n,null,{default:t(()=>[e(u(X))]),_:1}),a[5]||(a[5]=l("span",null,"草稿箱",-1)),g.value>0?(b(),w(S,{key:0,value:g.value,class:"folder-badge",type:"info"},null,8,["value"])):F("",!0)]),_:1}),e(m,{index:"trash"},{default:t(()=>[e(n,null,{default:t(()=>[e(u(Y))]),_:1}),a[6]||(a[6]=l("span",null,"垃圾箱",-1))]),_:1})]),_:1},8,["default-active"]),l("div",oe,[e(z,{trigger:"click"},{dropdown:t(()=>[e(M,null,{default:t(()=>[e(i,{onClick:E},{default:t(()=>[e(n,null,{default:t(()=>[e(u(h))]),_:1}),a[7]||(a[7]=d(" 邮箱账号管理 ",-1))]),_:1}),e(i,{onClick:I},{default:t(()=>[e(n,null,{default:t(()=>[e(u(N))]),_:1}),a[8]||(a[8]=d(" 退出登录 ",-1))]),_:1})]),_:1})]),default:t(()=>[l("div",se,[e(y,{size:36},{default:t(()=>[d(r(x.value),1)]),_:1}),l("span",ne,r(_.value),1)])]),_:1})])]),_:1}),e(A,{class:"right-container"},{default:t(()=>[e(j,{class:"top-header"},{default:t(()=>[l("div",ue,[l("span",de,r($.value),1)]),l("div",re,[e(z,{trigger:"click"},{dropdown:t(()=>[e(M,null,{default:t(()=>[e(i,{disabled:""},{default:t(()=>[e(n,null,{default:t(()=>[e(u(ee))]),_:1}),d(" "+r(_.value),1)]),_:1}),e(i,{disabled:""},{default:t(()=>[e(n,null,{default:t(()=>[e(u(h))]),_:1}),d(" "+r(k.value),1)]),_:1}),e(i,{divided:"",onClick:I},{default:t(()=>[e(n,null,{default:t(()=>[e(u(N))]),_:1}),a[9]||(a[9]=d(" 退出登录 ",-1))]),_:1})]),_:1})]),default:t(()=>[l("div",_e,[e(y,{size:32},{default:t(()=>[d(r(x.value),1)]),_:1}),l("div",ie,[l("span",ce,r(_.value),1),l("span",me,r(k.value),1)]),e(n,null,{default:t(()=>[e(u(Z))]),_:1})])]),_:1})])]),_:1}),e(D,{class:"main-content"},{default:t(()=>[e(q)]),_:1})]),_:1})]),_:1})}}},be=G(fe,[["__scopeId","data-v-c702b7b1"]]);export{be as default};
